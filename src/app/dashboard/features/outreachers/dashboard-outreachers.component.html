<section class="min-h-[105vh] text-gray-600 dashboard-main-content">
  @if (store.isLoading()) {
    <div class="flex items-center justify-between mb-8">
      <div class="h-5 w-52 rounded-md bg-gray-200 animate-pulse"></div>
    </div>
    <div class="grid grid-cols-2 overflow-x-auto">
      @for (i of skeletonArray; track $index) {
        <div class="border-y border-gray-200 py-3 px-2">
          <div class="h-4 w-1/3 rounded-md bg-gray-200 animate-pulse mb-2"></div>
        </div>
      }
    </div>
  }

  @if (store.outreachers()?.[1] === 0) {
    <p>Aucun appel trouvé.</p>
  }

  @if (store.outreachers()?.[0]; as outreachers) {
    <p-table [size]="'small'" [value]="outreachers" stripedRows [tableStyle]="{ 'min-width': '20rem' }">
      <ng-template #caption>
        <div class="flex items-center justify-between mb-8">
          <h5 class="text-lg font-bold">Liste des vulgarisateurs</h5>
          <button
            pButton
            class="w-1/5!"
            [outlined]="true"
            [size]="'small'"
            [loading]="store.isDownLoadingCSV()"
            [disabled]="store.isDownLoadingCSV()"
            (click)="downloadOutreachersCSV()">
            @if (!store.isDownLoadingCSV()) {
              <i-lucide [name]="icons.download" class="size-4" />
            }
            Télécharger CSV
          </button>
        </div>
      </ng-template>
      <ng-template #header>
        <tr>
          <th>Email</th>
          <th>Stats</th>
          <!-- <th>Actions</th> -->
        </tr>
      </ng-template>
      <ng-template #body let-outreacher>
        <tr>
          <td class="py-3">{{ outreacher.user_outreacher | titlecase }}</td>
          <td class="py-3">{{ outreacher.count }}</td>
          <!-- <td>
            <div class="flex items-center gap-2">
              <button>
                <i-lucide [name]="icons.edit" class="size-4" />
              </button>
              <button>
                <i-lucide [name]="icons.trash" class="size-4" />
              </button>
            </div>
          </td> -->
        </tr>
      </ng-template>
      <ng-template #footer>
        @if ((store.outreachers()?.[1] || 0) > 30) {
          <tr>
            <td colspan="5" class="text-center text-sm">
              <div class="card flex justify-center text-center text-sm mt-2">
                <p-paginator
                  (onPageChange)="onPageChange($event)"
                  [first]="queryParams().page ? ((queryParams().page || 0) - 1) * 40 : 0"
                  [rows]="40"
                  [pageLinkSize]="5"
                  [showCurrentPageReport]="true"
                  [currentPageReportTemplate]="'{currentPage} sur {totalPages}'"
                  [totalRecords]="store.outreachers()?.[1]" />
              </div>
            </td>
          </tr>
        }
      </ng-template>
    </p-table>
  }
</section>
